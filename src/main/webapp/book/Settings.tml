<html t:type="layout"
	xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
	xmlns:p="tapestry:parameter">

	<h1><a t:type="pagelink" t:page="book/index" t:context="book.id">${book.title}</a></h1>

	<div class="left-col">
		<div id="general-settings" class="section shadowed x460">
			<h2>General Settings</h2>
			<form t:type="form" t:id="bookInfoForm" class="small-form">
				<t:errors />
				<table>
					<tr>
						<td>
							<label t:type="label" t:for="title"></label><input t:validate="required" t:type="textfield" t:id="title" t:value="book.title"/>
						</td>
					</tr>
				</table>
				<div class="form-submit">
					<t:submit class="btn-active" t:value="Update" /> or <a href="#" t:type="pagelink" t:page="book/settings" t:mixins="ResetFormOnClick">cancel</a>
				</div>
			</form>
		</div>
	</div>
	<div class="right-col">
		<div id="authors-settings" class="feed section shadowed x300 ">
			<h2>Author List</h2>
			<t:security.ifOwnerOfBook t:bookId="bookId">
				<form t:type="form" t:id="addAuthorForm" t:mixins="append" t:to="authors-list" t:position="top" class="small-form">
					<table>
						<tr>
							<td>
								<input t:type="textfield" t:id="newAuthor" t:mixins="autocomplete" class="form-field" size="15"/>
							</td>
							<td>
								<input t:type="submit" class="btn-active" t:value="Add author" />
							</td>
						</tr>
					</table>
				</form>
			</t:security.ifOwnerOfBook>
			<t:block id="authorRow">
				<li id="ent-${currentAuthor.id}" class="${style}">
					<t:if test="!loggedAuthor">
						<span><a t:type="pagelink" t:page="Index" t:context="currentAuthor.username">${currentAuthor.username}</a> (${currentAuthor.fullname})</span>
						<t:security.ifOwnerOfBook t:bookId="bookId">
							<a href="#" t:type="clickAndRemove" t:entityId="currentAuthor.id">Remove</a>
						</t:security.ifOwnerOfBook>
						<p:else>
							<a t:type="pagelink" t:page="Index" t:context="currentAuthor.username">${currentAuthor.username}</a> (${currentAuthor.fullname})
						</p:else>
					</t:if>
				</li>
			</t:block>
			<ul id="authors-list">
				<t:loop source="authors" value="currentAuthor" index="rowIndex">
					<t:delegate t:to="block:authorRow" />
				</t:loop>
			</ul>
		</div>
	</div>
</html>
